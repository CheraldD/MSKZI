import matplotlib.pyplot as plt

# Данные
frequencies = {
    'p1': [499798, 500202],
    'p2': [250064, 249735, 249735, 250466],
    'p3': [124915, 125150, 124743, 124992, 125149, 124585, 124992, 125474],
    'p4': [62359, 62557, 62413, 62737, 62301, 62442, 62420, 62572, 62556, 62593, 62330, 62255, 62848, 62143, 62572, 62902]
}

relative_frequencies = {
    'p1': [0.499798, 0.500202],
    'p2': [0.250064, 0.249735, 0.249735, 0.250466],
    'p3': [0.124915, 0.12515, 0.124743, 0.124992, 0.125149, 0.124585, 0.124992, 0.125474],
    'p4': [0.0623592, 0.0625572, 0.0624132, 0.0627372, 0.0623012, 0.0624422, 0.0624202, 0.0625722,
           0.0625562, 0.0625932, 0.0623302, 0.0622552, 0.0628482, 0.0621432, 0.0625722, 0.0629022]
}

acf = [1, 0.001056, -0.000568, -0.001232, 0.000996, -5.4e-05, 0.000652, -0.000794, 2.8e-05, -4.4e-05,
       -0.000924, -0.00052, -0.000754, 0.00175, -0.000816, 0.001726, 0, 0.00129, -0.000254, -0.00151,
       0.000434, 0.001542, 0.001062, -0.000578, -0.000316, -0.001286, 0.001274, 0.0011, 0.001056, -0.001026,
       0.000254, -0.001226]

# Бинарные метки для оси x
binary_labels = {
    'p1': ['0', '1'],
    'p2': ['00', '01', '10', '11'],
    'p3': ['000', '001', '010', '011', '100', '101', '110', '111'],
    'p4': ['0000', '0001', '0010', '0011', '0100', '0101', '0110', '0111', '1000', '1001', '1010', '1011', '1100', '1101', '1110', '1111']
}

# Построение графиков
plt.figure(figsize=(12, 8))

plt.subplot(3, 1, 1)
for p, values in frequencies.items():
    plt.plot(values, marker='o', label=p)
    plt.xticks(range(len(values)), binary_labels[p])
plt.title("Частоты появления последовательностей")
plt.legend()

plt.subplot(3, 1, 2)
for p, values in relative_frequencies.items():
    plt.plot(values, marker='x', label=p)
    plt.xticks(range(len(values)), binary_labels[p])
plt.title("Относительные частоты последовательностей")
plt.legend()

plt.subplot(3, 1, 3)
plt.stem(range(len(acf)), acf, basefmt="C0-")
plt.title("Автокорреляционная функция")

plt.tight_layout()
plt.show()
